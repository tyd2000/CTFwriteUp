# 数据流量分析溯源

### “三步走”策略

- 基于已知流量进行过滤。
- 基于分析信息进行过滤，根据过滤语句进行过滤。
- 追踪流
  - 优先推荐追踪TCP流。
  - HTTP在TCP基础上，去除了部分信息。对需要提取的数据不太明确的情况下，推荐HTTP追踪流；而相对明确的文件数据，推荐更全的TCP追踪流。
- 数据提取
  - 字符串提取
  - 文件提取
    - 追踪流分析出来的信息进行提取。
    - 导出对象：HTTP/FTP。

### WireShark

- 过滤HTTP协议：`http`。
  - 过滤所有的HTTP流量：`http`。
  - 过滤特定主机的HTTP流量：`http.host == "www.xxx.com"`。
  - 过滤特定URL的HTTP请求：`http.request.url contains "/login"`。
  - 过滤特定方法的HTTP请求：`http.request.method == "POST"`。
  - 过滤特定状态码的HTTP响应：`http.response.code == 200`。
  - 筛选HTTP协议中内容包含"flag"字符串的流量：`http contains "flag"`。
  - 按照HTTP协议且IP目的地址为192.168.1.1进行组合过滤： `http && ip.dst == 192.168.1.1`

- 过滤TCP协议：`tcp`。

- 根据IP地址过滤
  - 过滤出源IP地址或目的IP地址都是127.0.0.1的数据包：`ip.addr == 127.0.0.1`。
  - 筛选出源IP地址是192.168.1.1的数据包：`ip.src_host == 192.168.1.1`。
  - 筛选出目的IP地址是192.168.1.1的数据包：`ip.dst_host == 192.168.1.1`。
- 根据端口过滤
  - 根据TCP端口80过滤数据包，包括源端口和目的端口：`tcp.port == 80`。
  - 根据TCP目的端口80筛选数据包：`tcp.dstport == 80`。

- 根据协议过滤
  - 筛选出HTTP协议中GET请求的数据包：`http.request.method == GET`。
    GET一定要大写
  - 筛选出HTTP协议中POST请求的数据包：`http.request.method == POST`。
    POST一定要大写